(this["webpackJsonpreact-spa"]=this["webpackJsonpreact-spa"]||[]).push([[0],{229:function(e,t,n){},253:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a,c,r,i,o,s,l,d=n(0),u=n.n(d),j=n(21),b=n.n(j),p=(n(229),n(52)),m=n(204),O=n(26),g=n(28),h=n(107),f=n(23),x=n(177),v=(n(253),n(196)),k=Object(O.createHttpLink)({uri:"".concat("http://localhost:3000","/graphql")}),y=Object(v.a)((function(e,t){var n=t.headers,a=localStorage.getItem("token");return{headers:Object(p.a)(Object(p.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})),w=new O.ApolloClient({link:y.concat(k),cache:new O.InMemoryCache}),S=n(48),_=n.n(S),T=n(78),q=n(71),C=n(63),I=n(324),$=n(316),A=n(305),N=n(94),F=(n(267),n(317)),L=n(310),W=n(318),D=n(319),M=n(320),G=n(202),P=n.n(G),B=n(311),V=n(201),E=n.n(V),J=n(95),Q=n(312),U=n(315),z=n(19),H=n(79),R=n(313),K=n(314),X=n(9),Y=u.a.memo((function(e){var t=Object(z.e)().isSubmitting;return Object(X.jsxs)(R.a,Object(p.a)(Object(p.a)({},e),{},{disabled:t,children:[!t&&e.children,t&&Object(X.jsx)(K.a,{})]}))})),Z=Object(Q.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),ee=Object(O.gql)(a||(a=Object(C.a)(["\n  query User {\n    user {\n      _id\n      email\n    }\n  }\n"]))),te=Object(O.gql)(c||(c=Object(C.a)(["\n  query Todos {\n    todos {\n      _id\n      description\n      complete\n      createdAt\n    }\n  }\n  "]))),ne=Object(O.gql)(r||(r=Object(C.a)(["\n  mutation AddTodo($description: String!) {\n    addTodo(description: $description) {\n      _id\n      description\n      complete\n      createdAt\n    }\n  }\n"]))),ae=Object(O.gql)(i||(i=Object(C.a)(["\n  mutation CompleteTodo($_id: ID!) {\n    completeTodo(_id: $_id) {\n      _id\n      description\n      complete\n      createdAt\n    }\n  }\n"]))),ce=Object(O.gql)(o||(o=Object(C.a)(["\n  mutation RemoveTodo($_id: ID!) {\n    removeTodo(_id: $_id) {\n      _id\n      description\n      complete\n      createdAt\n    }\n  }\n"]))),re=function(e){var t=Z(),n=Object(g.g)(),a=Object(d.useState)(""),c=Object(q.a)(a,2),r=c[0],i=c[1],o=Object(O.useMutation)(ne),s=Object(q.a)(o,1)[0],l=Object(O.useMutation)(ae),u=Object(q.a)(l,1)[0],j=Object(O.useMutation)(ce),b=Object(q.a)(j,1)[0],p=Object(O.useQuery)(ee).data,m=Object(O.useQuery)(te),h=(m.loading,m.error),f=m.data,x=m.refetch,v=Object(H.get)(p,"user.email");h&&console.log("error",h);var k=function(){var e=Object(T.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({variables:{_id:t._id}});case 2:e.sent,x();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(T.a)(_.a.mark((function e(t){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{_id:t._id}});case 2:e.sent,x();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(X.jsxs)(U.a,{component:"main",maxWidth:"xs",children:[Object(X.jsx)($.a,{}),Object(X.jsxs)("div",{className:t.paper,children:[Object(X.jsx)(I.a,{className:t.avatar,children:Object(X.jsx)(E.a,{})}),Object(X.jsx)(J.a,{component:"h1",variant:"h5",children:"Todos"}),v&&Object(X.jsxs)(J.a,{component:"h2",variant:"h6",children:[v,"\xa0",Object(X.jsx)(F.a,{href:"#",onClick:function(e){e.preventDefault(),localStorage.removeItem("token"),n.go(0)},children:"logout"})]}),Object(X.jsx)(A.a,{type:"search",placeholder:"Search",fullWidth:!0,onChange:function(e){return i(e.target.value)},style:{marginTop:20}}),Object(X.jsx)(L.a,{style:{width:"100%",marginTop:20},children:f&&f.todos&&f.todos.filter((function(e){return e.description.includes(r)})).map((function(e){return Object(X.jsxs)(W.a,{button:!0,onClick:function(){return k(e)},children:[Object(X.jsx)(D.a,{primary:e.description,style:{textDecoration:e.complete?"line-through":"none"}}),Object(X.jsx)(M.a,{children:Object(X.jsx)(B.a,{onClick:function(){return y(e)},edge:"end","aria-label":"delete",children:Object(X.jsx)(P.a,{})})})]},e._id)}))}),Object(X.jsx)(z.c,{initialValues:{description:""},onSubmit:function(){var e=Object(T.a)(_.a.mark((function e(t,n){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.setSubmitting,c=n.resetForm,e.next=3,s({variables:t});case 3:e.sent,x(),c(),a(!0);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:Object(X.jsxs)(z.b,{className:t.form,noValidate:!0,children:[Object(X.jsx)(z.a,{name:"description",component:N.a,placeholder:"Add a todo",fullWidth:!0,required:!0,autoComplete:"todo",autoFocus:!0,variant:"outlined",margin:"normal"}),Object(X.jsx)(Y,{style:{marginTop:0},type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,children:"Add"})]})})]})]})},ie=n(140),oe=n.n(ie),se=n(203),le=Object(Q.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),de=Object(O.gql)(s||(s=Object(C.a)(["\n  mutation Login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      _id\n      token\n    }\n  }\n  "]))),ue=Object(O.gql)(l||(l=Object(C.a)(["\n  mutation LoginGoogle($token: String!) {\n    loginGoogle(token: $token) {\n      _id\n      token\n    }\n  }\n  "])));function je(){var e=le(),t=Object(g.g)(),n=Object(O.useMutation)(de),a=Object(q.a)(n,2),c=a[0],r=(a[1].data,Object(O.useMutation)(ue)),i=Object(q.a)(r,2),o=i[0],s=(i[1].dataGoogle,function(){var e=Object(T.a)(_.a.mark((function e(n){var a,c,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(H.get)(n,"profileObj.email"),a=Object(H.get)(n,"tokenId"),e.next=4,o({variables:{token:a}});case 4:c=e.sent,(r=Object(H.get)(c,"data.loginGoogle.token"))&&(localStorage.setItem("token",r),t.push("/"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return Object(X.jsxs)(U.a,{component:"main",maxWidth:"xs",children:[Object(X.jsx)($.a,{}),Object(X.jsxs)("div",{className:e.paper,children:[Object(X.jsx)(I.a,{className:e.avatar,children:Object(X.jsx)(oe.a,{})}),Object(X.jsx)(J.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(X.jsx)(z.c,{initialValues:{email:"",password:""},onSubmit:function(){var e=Object(T.a)(_.a.mark((function e(n,a){var r,i,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.setSubmitting,e.next=3,c({variables:Object(p.a)({},n)});case 3:i=e.sent,(o=Object(H.get)(i,"data.login.token"))&&(localStorage.setItem("token",o),t.push("/")),r(!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:Object(X.jsxs)(z.b,{className:e.form,noValidate:!0,children:[Object(X.jsx)(z.a,{name:"email",component:N.a,placeholder:"Email Address",fullWidth:!0,required:!0,autoComplete:"email",autoFocus:!0,variant:"outlined",margin:"normal"}),Object(X.jsx)(z.a,{name:"password",component:N.a,type:"password",placeholder:"Password",fullWidth:!0,required:!0,variant:"outlined",margin:"normal"}),Object(X.jsx)(Y,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit,children:"Sign Up / Login"})]})}),Object(X.jsx)("p",{style:{marginBottom:25},children:"or"}),Object(X.jsx)(se.GoogleLogin,{clientId:"437227484786-h2tdsihqrvgbl2qda0nvkf42ri4e2nct.apps.googleusercontent.com",buttonText:"Login with Google",onSuccess:s,onFailure:s,cookiePolicy:"single_host_origin"})]})]})}var be=function(){var e=function(e){var t=e.children,n=Object(m.a)(e,["children"]),a=localStorage.getItem("token");return Object(X.jsx)(g.b,Object(p.a)(Object(p.a)({},n),{},{render:function(e){var n=e.location;return a?t:Object(X.jsx)(g.a,{to:{pathname:"/login",state:{from:n}}})}}))};return Object(X.jsx)("div",{className:"App",children:Object(X.jsx)(O.ApolloProvider,{client:w,children:Object(X.jsx)(f.a,{utils:x.a,children:Object(X.jsx)(h.a,{children:Object(X.jsxs)(g.d,{children:[Object(X.jsx)(g.b,{path:"/login",children:Object(X.jsx)(je,{})}),Object(X.jsx)(e,{path:"/",children:Object(X.jsx)(re,{})})]})})})})})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,325)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};b.a.render(Object(X.jsx)(u.a.StrictMode,{children:Object(X.jsx)(be,{})}),document.getElementById("root")),pe()}},[[268,1,2]]]);
//# sourceMappingURL=main.3ab192b5.chunk.js.map